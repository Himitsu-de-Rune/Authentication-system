## Собственная система аутентификации и авторизации

# Структура базы данных и модель доступа

## Таблица `users`
- `id` — первичный ключ  
- `first_name` — имя  
- `last_name` — фамилия  
- `email` — уникальный идентификатор для входа  
- `password_hash` — хэш пароля  
- `is_active` — флаг активности пользователя  
- `role_id` — внешний ключ на таблицу `roles`

---

## Таблица `sessions`
- `id` — первичный ключ  
- `user_id` — внешний ключ на `users.id`  
- `token` — уникальный сессионный токен, определяющий текущего пользователя

---

## Таблица `roles`
- `id` — первичный ключ  
- `name` — уникальное имя роли

---

## Таблица `permissions`
- `id` — первичный ключ  
- `role_id` — внешний ключ на `roles.id`  
- `resource` — имя ресурса (например: `items`, `users`)  
- `action` — разрешённое действие (`read`, `write`, `delete`)

---

# Модель доступа (RBAC)

Система использует ролевую модель доступа (Role-Based Access Control):

1. Каждый пользователь привязан к одной роли.  
2. Каждая роль имеет набор разрешений.  
3. Разрешение — это пара:
   - `resource` — ресурс (например: `items`)  
   - `action` — действие (`read`, `write`, `delete`)
4. При запросе к защищённому API система проверяет, существует ли разрешение для роли пользователя.  
5. Если разрешения нет — возвращается **403 Forbidden**.  
6. Если пользователь не аутентифицирован — **401 Unauthorized**.

